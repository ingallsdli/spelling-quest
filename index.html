<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lincoln's Spelling Quest</title>
<style>
  :root{
    --bg:#0b1220; --text:#e9eefc; --muted:#a9b6da;
    --ok:#33d17a; --bad:#ff5c5c; --btn:#1a2644; --btn2:#22335c;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    background: radial-gradient(1200px 600px at 50% -20%, #1a2c5e 0%, var(--bg) 60%);
    color:var(--text);
    min-height:100vh;
    display:flex; align-items:center; justify-content:center;
    padding:18px;
  }
  .card{
    width:min(980px,100%);
    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
    border:1px solid rgba(255,255,255,0.10);
    border-radius:18px;
    padding:16px;
    box-shadow: 0 18px 40px rgba(0,0,0,0.35);
  }
  h1{margin:0 0 6px; font-size:28px;}
  .sub{color:var(--muted); margin:0 0 10px; line-height:1.35; font-weight:600;}
  .top{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:10px;}
  .pill{
    display:inline-flex; align-items:center; gap:8px;
    background: rgba(44,97,255,0.16);
    border:1px solid rgba(44,97,255,0.25);
    padding:8px 12px; border-radius:999px; font-weight:1000;
  }
  .progress{
    height:12px; border-radius:999px;
    background: rgba(255,255,255,0.10);
    overflow:hidden;
    border:1px solid rgba(255,255,255,0.10);
    flex:1; min-width:220px;
  }
  .bar{
    height:100%;
    background: linear-gradient(90deg, #2c61ff, #9b7bff);
    width:0%;
    transition: width 220ms ease;
  }
  button{
    border:0; cursor:pointer;
    background: var(--btn);
    color: var(--text);
    padding:14px 16px;
    border-radius:14px;
    font-size:18px;
    font-weight:1000;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.10);
    user-select:none;
  }
  button.primary{background: linear-gradient(180deg, #2c61ff, #2a4bcc);}
  button.alt{background: var(--btn2);}
  button.good{background: rgba(51,209,122,0.20); box-shadow: inset 0 0 0 1px rgba(51,209,122,0.30);}
  button.warn{background: rgba(255,92,92,0.18); box-shadow: inset 0 0 0 1px rgba(255,92,92,0.28);}
  .inputWrap{margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
  input{
    flex:1 1 320px;
    padding:16px 14px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,0.16);
    background: rgba(0,0,0,0.22);
    color: var(--text);
    font-size:22px;
    font-weight:1000;
    letter-spacing: .8px;
  }
  .msg{
    margin-top:12px;
    padding:12px 12px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,0.10);
    background: rgba(0,0,0,0.18);
    min-height:56px;
    display:flex; align-items:center;
    color: var(--muted);
    line-height:1.3;
    font-weight:900;
  }
  .msg.ok{color:#c9ffe1; border-color: rgba(51,209,122,0.35); background: rgba(51,209,122,0.10);}
  .msg.bad{color:#ffd2d2; border-color: rgba(255,92,92,0.35); background: rgba(255,92,92,0.10);}
  .kbd{
    margin-top:14px;
    display:grid;
    grid-template-columns: repeat(10, minmax(0,1fr));
    gap:10px;
  }
  .k{
    padding:16px 0;
    text-align:center;
    border-radius:14px;
    background: rgba(255,255,255,0.08);
    border:1px solid rgba(255,255,255,0.10);
    font-weight:1000;
    font-size:20px;
  }
  .kbd .wider{grid-column: span 3;}
  .tiny{font-size:12px;color:rgba(233,238,252,.7);margin-top:10px;line-height:1.35;}
</style>
</head>

<body>
<div class="card">
  <h1>Lincoln's Spelling Quest</h1>
  <p class="sub">Audio-only spelling. Listen to the word. Type it (or tap letters). Pass <b>10</b> words to finish.</p>

  <div class="top">
    <span class="pill">‚≠ê Progress: <span id="count">0</span>/10</span>
    <div class="progress"><div class="bar" id="bar"></div></div>
    <button class="primary" onclick="start()">‚ñ∂ Start / Next Word</button>
    <button class="alt" onclick="testVoice()">Test Voice</button>
  </div>

  <div class="inputWrap">
    <input id="answer" placeholder="Type here‚Ä¶" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
    <button class="alt" onclick="repeat()">üîä Hear Again</button>
    <button class="alt" onclick="hint()">üí° Hint</button>
    <button class="good" onclick="check()">‚úÖ Check</button>
    <button class="warn" onclick="clearBox()">‚å´ Clear</button>
  </div>

  <div class="msg" id="msg">Tap <b>Start</b> To Begin.</div>
  <div class="kbd" id="kbd"></div>

  <div class="tiny">Tip: After editing on GitHub, open with <b>?v=NEW</b> and press <b>Ctrl + F5</b>.</div>
</div>

<script>
/* Pass 10 */
const PASS_TARGET = 10;

/* Bank of words (hidden) */
const WORD_BANK = [
  { w:"because", chunk:"be + cause" },
  { w:"before", chunk:"be + fore" },
  { w:"around", chunk:"a + round" },
  { w:"first", chunk:"furst" },
  { w:"found", chunk:"fownd" },
  { w:"would", chunk:"wood" },
  { w:"where", chunk:"wair" },
  { w:"right", chunk:"r + ight" },
  { w:"little", chunk:"lit + tle" },
  { w:"always", chunk:"all + ways" },
  { w:"pretty", chunk:"pret + ty" },
  { w:"people", chunk:"pee + pul" },
  { w:"mother", chunk:"muth + er" },
  { w:"school", chunk:"skool" },
  { w:"friend", chunk:"frend" },
  { w:"should", chunk:"shood" },
  { w:"answer", chunk:"an + ser" },
  { w:"great", chunk:"gr + ate" }
];

/* Praise variety */
const PRAISE = [
  "Great job, Lincoln!",
  "You're rocking now, Lincoln!",
  "Keep up the great work, Lincoln!",
  "Awesome spelling, Lincoln!",
  "Nice work, Lincoln!"
];

/* STATE */
let passed = new Set();
let current = null;
let attempts = 0;
let hintLevel = 0;

/* Session list of 10, randomized each session */
let session = [];
let sessionPos = 0;

/* VOICES */
let VOICES = [];
function loadVoices(){ VOICES = speechSynthesis.getVoices() || []; }
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

function pickFemaleVoice(){
  const preferred = ["Zira","Aria","Jenny"];
  for (const p of preferred){
    const v = VOICES.find(v => (v.name||"").includes(p));
    if (v) return v;
  }
  return VOICES.find(v => (v.lang||"").startsWith("en")) || VOICES[0] || null;
}

/* Slower another 10% from 0.88 => ~0.79 */
const RATE = 0.79;

function speak(text, after=null, afterDelayMs=0){
  const u = new SpeechSynthesisUtterance(text);
  const v = pickFemaleVoice();
  if (v) u.voice = v;
  u.lang = "en-US";
  u.rate = RATE;
  u.pitch = 1.08;

  if (after){
    u.onend = () => setTimeout(after, afterDelayMs);
    u.onerror = () => setTimeout(after, afterDelayMs);
  }

  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

/* Helpers */
function setMsg(text, cls){
  const m = document.getElementById("msg");
  m.className = "msg" + (cls ? (" " + cls) : "");
  m.innerHTML = text;
}
function updateProgress(){
  document.getElementById("count").textContent = passed.size;
  document.getElementById("bar").style.width = `${Math.min(100, (passed.size/PASS_TARGET)*100)}%`;
}
function normalize(x){ return (x||"").toLowerCase().replace(/[^a-z']/g,'').trim(); }
function randFrom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function shuffleCopy(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

/* New random set of 10 each time */
function newSession(){
  passed = new Set();
  current = null;
  attempts = 0;
  hintLevel = 0;
  sessionPos = 0;
  session = shuffleCopy(WORD_BANK).slice(0, Math.min(PASS_TARGET, WORD_BANK.length));
  updateProgress();
  setMsg("Tap <b>Start</b> To Begin.");
}

/* Flow */
function start(){
  if (session.length === 0 || passed.size >= PASS_TARGET){
    newSession();
  }
  nextWord();
}

function nextWord(){
  if (passed.size >= PASS_TARGET || sessionPos >= session.length){
    setMsg("üéâ Lesson complete! Great job, Lincoln!", "ok");
    speak("You did it, Lincoln! Great job!");
    return;
  }
  current = session[sessionPos++];
  attempts = 0;
  hintLevel = 0;
  document.getElementById("answer").value = "";
  document.getElementById("answer").focus();
  setMsg("Listen carefully, then spell the word.");
  speak("Okay Lincoln. The word is " + current.w + ".");
}

function repeat(){
  if(!current){ setMsg("Tap <b>Start</b> To Begin."); return; }
  speak("The word is " + current.w + ".");
}

function hint(){
  if(!current){ setMsg("Tap <b>Start</b> To Begin."); return; }
  if (hintLevel === 0){
    setMsg("üí° Hint: Listen slowly.");
    const u = new SpeechSynthesisUtterance("Listen slowly: " + current.w + ".");
    const v = pickFemaleVoice();
    if (v) u.voice = v;
    u.lang="en-US"; u.rate=0.70; u.pitch=1.08;
    speechSynthesis.cancel(); speechSynthesis.speak(u);
  } else if (hintLevel === 1){
    setMsg("üí° Hint: Number of letters.");
    speak("This word has " + current.w.length + " letters.");
  } else if (hintLevel === 2){
    setMsg("üí° Hint: Starting letter.");
    speak("The word starts with " + current.w[0].toUpperCase() + ".");
  } else {
    setMsg("üí° Hint: Word chunk.");
    speak("Think of it like: " + (current.chunk || "listen to the sounds") + ".");
  }
  hintLevel = Math.min(3, hintLevel + 1);
}

function check(){
  if(!current){ setMsg("Tap <b>Start</b> To Begin."); return; }
  const a = normalize(document.getElementById("answer").value);
  if(!a){
    setMsg("Type (or tap) your answer first.");
    speak("Type your answer first, Lincoln.");
    return;
  }
  if (a === normalize(current.w)){
    passed.add(current.w);
    updateProgress();
    const praise = randFrom(PRAISE);
    setMsg("‚úÖ " + praise, "ok");

    /* Pause 1s after praise finishes before next word */
    speak(praise, () => nextWord(), 1000);

  } else {
    attempts++;
    setMsg("‚ùå Try again, Lincoln.", "bad");
    speak("Try again, Lincoln.");
    if (attempts === 2 || attempts === 3) setTimeout(hint, 450);
    if (attempts >= 4) document.getElementById("answer").value = "";
    document.getElementById("answer").focus();
  }
}

function clearBox(){
  document.getElementById("answer").value = "";
  document.getElementById("answer").focus();
}

function testVoice(){
  setMsg("üîä Testing voice‚Ä¶");
  speak("Hello Lincoln. This is your spelling quest voice.");
}

/* Tap keyboard */
const keys = "qwertyuiopasdfghjklzxcvbnm".split("");
function renderKbd(){
  const kbd = document.getElementById("kbd");
  kbd.innerHTML = "";
  keys.forEach(ch=>{
    const b = document.createElement("button");
    b.className = "k";
    b.textContent = ch.toUpperCase();
    b.onclick = ()=>{ document.getElementById("answer").value += ch; document.getElementById("answer").focus(); };
    kbd.appendChild(b);
  });
  const wide = (label, fn) => {
    const b = document.createElement("button");
    b.className = "k wider";
    b.textContent = label;
    b.onclick = fn;
    kbd.appendChild(b);
  };
  wide("‚å´ BACK", ()=>{ const v=document.getElementById("answer").value; document.getElementById("answer").value=v.slice(0,-1); document.getElementById("answer").focus(); });
  wide("CLEAR", clearBox);
  wide("CHECK", check);
  wide("HEAR", repeat);
  wide("HINT", hint);
}
renderKbd();

document.getElementById("answer").addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){ e.preventDefault(); check(); }
});

/* Init */
newSession();
setTimeout(loadVoices, 500);
setTimeout(loadVoices, 1500);
</script>
</body>
</html>